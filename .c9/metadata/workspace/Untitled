{"changed":true,"filter":false,"title":"Untitled","tooltip":"/Untitled","value":"<?php\n/*****************************\n\tFile: login.php\n\tWritten by: Frost of Slunked.com\n\tTutorial: User Registration and Login System\n******************************/\nrequire($_SERVER['DOCUMENT_ROOT'] . 'login/includes/config.php');\n\n// If the user is logging in or out\n// then lets execute the proper functions\nif (isset($_GET['action'])) {\n\tswitch (strtolower($_GET['action'])) {\n\t\tcase 'login':\n\t\t\tif (isset($_POST['username']) && isset($_POST['password'])) {\n\t\t\t\t// We have both variables. Pass them to our validation function\n\t\t\t\tif (!validateUser($_POST['username'], $_POST['password'])) {\n\t\t\t\t\t// Well there was an error. Set the message and unset\n\t\t\t\t\t// the action so the normal form appears.\n\t\t\t\t\t$_SESSION['error'] = \"Bad username or password supplied.\";\n\t\t\t\t\tunset($_GET['action']);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\t$_SESSION['error'] = \"Username and Password are required to login.\";\n\t\t\t\tunset($_GET['action']);\n\t\t\t}\t\t\t\n\t\tbreak;\n\t\tcase 'logout':\n\t\t\t// If they are logged in log them out.\n\t\t\t// If they are not logged in, well nothing needs to be done.\n\t\t\tif (loggedIn()) {\n\t\t\t\tlogoutUser();\n\t\t\t\t$sOutput .= '<h1>Logged out!</h1><br />You have been logged out successfully. \n\t\t\t\t\t\t<br /><h4>Would you like to go to <a href=\"index.php\">site index</a>?</h4>';\n\t\t\t}else {\n\t\t\t\t// unset the action to display the login form.\n\t\t\t\tunset($_GET['action']);\n\t\t\t}\n\t\tbreak;\n\t}\n}\n\n$sOutput .= '<div id=\"index-body\">';\n\n// See if the user is logged in. If they are greet them \n// and provide them with a means to logout.\nif (loggedIn()) {\n\t$sOutput .= '<h1>Logged In!</h1><br /><br />\n\t\tHello, ' . $_SESSION[\"username\"] . ' how are you today?<br /><br />\n\t\t<h4>Would you like to <a href=\"login.php?action=logout\">logout</a>?</h4>\n\t\t<h4>Would you like to go to <a href=\"index.php\">site index</a>?</h4>';\n}elseif (!isset($_GET['action'])) {\n\t// incase there was an error \n\t// see if we have a previous username\n\t$sUsername = \"\";\n\tif (isset($_POST['username'])) {\n\t\t$sUsername = $_POST['username'];\n\t}\n\t\n\t$sError = \"\";\n\tif (isset($_SESSION['error'])) {\n\t\t$sError = '<span id=\"error\">' . $_SESSION['error'] . '</span><br />';\n\t}\n\t\n\t$sOutput .= '<h2>Login to our site</h2><br />\n\t\t<div id=\"login-form\">\n\t\t\t' . $sError . '\n\t\t\t<form name=\"login\" method=\"post\" action=\"login.php?action=login\">\n\t\t\t\tUsername: <input type=\"text\" name=\"username\" value=\"' . $sUsername . '\" /><br />\n\t\t\t\tPassword: <input type=\"password\" name=\"password\" value=\"\" /><br /><br />\n\t\t\t\t<input type=\"submit\" name=\"submit\" value=\"Login!\" />\n\t\t\t</form>\n\t\t</div>\n\t\t<h4>Would you like to <a href=\"login.php\">login</a>?</h4>\n\t\t<h4>Create a new <a href=\"register.php\">account</a>?</h4>';\n}\n\n$sOutput .= '</div>';\n\n// lets display our output string.\necho $sOutput;\n?>","undoManager":{"mark":-1,"position":0,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":0,"column":0},"end":{"row":0,"column":5}},"text":"<?php"},{"action":"insertText","range":{"start":{"row":0,"column":5},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":1,"column":0},"end":{"row":80,"column":0}},"lines":["/*****************************","\tFile: login.php","\tWritten by: Frost of Slunked.com","\tTutorial: User Registration and Login System","******************************/","require($_SERVER['DOCUMENT_ROOT'] . 'login/includes/config.php');","","// If the user is logging in or out","// then lets execute the proper functions","if (isset($_GET['action'])) {","\tswitch (strtolower($_GET['action'])) {","\t\tcase 'login':","\t\t\tif (isset($_POST['username']) && isset($_POST['password'])) {","\t\t\t\t// We have both variables. Pass them to our validation function","\t\t\t\tif (!validateUser($_POST['username'], $_POST['password'])) {","\t\t\t\t\t// Well there was an error. Set the message and unset","\t\t\t\t\t// the action so the normal form appears.","\t\t\t\t\t$_SESSION['error'] = \"Bad username or password supplied.\";","\t\t\t\t\tunset($_GET['action']);","\t\t\t\t}","\t\t\t}else {","\t\t\t\t$_SESSION['error'] = \"Username and Password are required to login.\";","\t\t\t\tunset($_GET['action']);","\t\t\t}\t\t\t","\t\tbreak;","\t\tcase 'logout':","\t\t\t// If they are logged in log them out.","\t\t\t// If they are not logged in, well nothing needs to be done.","\t\t\tif (loggedIn()) {","\t\t\t\tlogoutUser();","\t\t\t\t$sOutput .= '<h1>Logged out!</h1><br />You have been logged out successfully. ","\t\t\t\t\t\t<br /><h4>Would you like to go to <a href=\"index.php\">site index</a>?</h4>';","\t\t\t}else {","\t\t\t\t// unset the action to display the login form.","\t\t\t\tunset($_GET['action']);","\t\t\t}","\t\tbreak;","\t}","}","","$sOutput .= '<div id=\"index-body\">';","","// See if the user is logged in. If they are greet them ","// and provide them with a means to logout.","if (loggedIn()) {","\t$sOutput .= '<h1>Logged In!</h1><br /><br />","\t\tHello, ' . $_SESSION[\"username\"] . ' how are you today?<br /><br />","\t\t<h4>Would you like to <a href=\"login.php?action=logout\">logout</a>?</h4>","\t\t<h4>Would you like to go to <a href=\"index.php\">site index</a>?</h4>';","}elseif (!isset($_GET['action'])) {","\t// incase there was an error ","\t// see if we have a previous username","\t$sUsername = \"\";","\tif (isset($_POST['username'])) {","\t\t$sUsername = $_POST['username'];","\t}","\t","\t$sError = \"\";","\tif (isset($_SESSION['error'])) {","\t\t$sError = '<span id=\"error\">' . $_SESSION['error'] . '</span><br />';","\t}","\t","\t$sOutput .= '<h2>Login to our site</h2><br />","\t\t<div id=\"login-form\">","\t\t\t' . $sError . '","\t\t\t<form name=\"login\" method=\"post\" action=\"login.php?action=login\">","\t\t\t\tUsername: <input type=\"text\" name=\"username\" value=\"' . $sUsername . '\" /><br />","\t\t\t\tPassword: <input type=\"password\" name=\"password\" value=\"\" /><br /><br />","\t\t\t\t<input type=\"submit\" name=\"submit\" value=\"Login!\" />","\t\t\t</form>","\t\t</div>","\t\t<h4>Would you like to <a href=\"login.php\">login</a>?</h4>","\t\t<h4>Create a new <a href=\"register.php\">account</a>?</h4>';","}","","$sOutput .= '</div>';","","// lets display our output string.","echo $sOutput;"]},{"action":"insertText","range":{"start":{"row":80,"column":0},"end":{"row":80,"column":2}},"text":"?>"}]}]]},"ace":{"folds":[],"scrolltop":682,"scrollleft":0,"selection":{"start":{"row":80,"column":2},"end":{"row":80,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":47,"state":"start","mode":"ace/mode/text"}},"timestamp":1413522049150}